import{d as u,U as d}from"./vendor-a962175c.js";import{r as n,v as l,C as a,o as g}from"./index-11d2d6b3.js";import{f as v}from"./index-8a0f43b8.js";function p(e,t="modal"){return n.get({url:"/api/EwpIncidentTemplate/EwpIncidentTemplateList",params:e},{errorMessageMode:t})}function h(e,t="modal"){return n.get({url:"/api/EwpIncidentTemplate/EwpSubmissionGroupTree",params:e},{errorMessageMode:t})}const m=u({id:"store-service",state:()=>({serviceCatalogList:null,serviceList:[],serviceGroupList:null,selectedProject:null,knowLedgeProjectId:null,customerAs:null}),getters:{getKnowledgeProjectId(e){return e.knowLedgeProjectId?e.knowLedgeProjectId:Number(localStorage.getItem(l))||null},getCustomerAs(e){return e.customerAs?e.customerAs:localStorage.getItem(a)||null}},actions:{async getServiceCatalogList(){const e=g(),t=await v(),o=new Set(e.getProjectId);this.serviceCatalogList=[];const c=(i,s)=>{for(const r of i)o.has(r.value.projectID)&&r.value.isActiveProject&&!r.value.isTemplateProject&&this.serviceCatalogList.push({projectId:r.value.projectID,projectName:r.value.projectName}),this.serviceCatalogList.length!==o.size&&r.children.length&&c(r.children,r),r.value.projectID==e.getBaseProjectId&&(s==null?void 0:s.value.projectTypeID)==31&&(this.customerAs=r.value.customerAs,this.knowLedgeProjectId=s==null?void 0:s.value.projectID,localStorage.setItem(l,JSON.stringify(this.knowLedgeProjectId)),localStorage.setItem(a,this.customerAs))};c(t),this.selectedProject=d(this.serviceCatalogList)},async getServiceList(e,t){if(t){this.serviceGroupList||await this.getServiceGroup(e),this.serviceList=[];const o=this.serviceGroupList.filter(i=>i.groupID==t)[0],c=i=>{this.serviceList=[...this.serviceList,...i.childIncidentTemplate],i.childGroup.length&&i.childGroup.map(s=>c(s))};c(o),this.serviceList.sort((i,s)=>i.displayOrder-s.displayOrder)}else{const o=await p({projectId:e});this.serviceList=o}},async getServiceGroup(e){const t=await h({projectId:e});this.serviceGroupList=t},clearKnowLedgeProjectId(){this.knowLedgeProjectId=null}}});export{m as u};
