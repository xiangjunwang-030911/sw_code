import{c as S}from"./index-4585b2cf.js";import{g as w,aQ as b,j as h,k as x,aR as I,ag as L,o as k,m as A,n as D,aS as O,aT as R,aU as T,aX as $,aV as B,aW as W}from"./vendor-a962175c.js";import"./index-11d2d6b3.js";const v=w({__name:"OrderStatus",props:{width:{default:"100%"},height:{default:"100%"},onResize:{default:()=>[0,0]},dateInfo:{default:()=>({})}},setup(m){b([O,R,T,$,B,W]);const u=m;let n=["SAP关键用户","IT工程师组","现场工程师组","SAP关键用户","IT工程师组","现场工程师组"],l=[["已解决工单",320,302,301,334,390,330,320],["未解决工单",120,132,101,134,90,230,210]];const c=["#2FD8FF","#F8635D","#FFD946","#3061F6","#61F5A9"];let o=null;const r={tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},legend:{itemWidth:15,itemHeight:15,right:0,icon:"roundRect",textStyle:{color:"#00"}},grid:{left:"3%",right:"4%",bottom:"0%",top:"18%",containLabel:!0},xAxis:[{type:"category",axisLine:{show:!1},axisLabel:{show:!0,color:"#FFFFFF",fontFamily:"MicrosoftYaHei",rotate:-15,opacity:.7,margin:20,interval:0,align:"center"},axisTick:{show:!1},splitLine:{show:!1},data:n}],yAxis:{type:"value",axisLabel:{show:!0,color:"#FFFFFF",fontFamily:"MicrosoftYaHei",opacity:.7,margin:18},axisTick:{show:!1},axisLine:{show:!1},splitLine:{show:!0,lineStyle:{color:"#2FD8FF",opacity:.2,type:"dashed"}}},series:[]},p=()=>{o==null||o.setOption(r)},F=()=>{if(r.series){r.series=[];let t=[];l.forEach((a,i)=>{i==0?t.push({name:a[0],type:"bar",stack:"total",itemStyle:{color:c[i],borderRadius:[0,0,4,4]},emphasis:{focus:"series"},barWidth:"22%",data:a.slice(1)}):i==l.length-1?t.push({name:a[0],type:"bar",stack:"total",itemStyle:{color:c[i],borderRadius:[4,4,0,0]},emphasis:{focus:"series"},barWidth:"22%",data:a.slice(1)}):t.push({name:a[0],type:"bar",stack:"total",itemStyle:{color:c[i]},emphasis:{focus:"series"},barWidth:"22%",data:a.slice(1)})}),r.xAxis=[{data:n}],r.series=t,setTimeout(()=>{p()},50)}},g=async(t,a)=>{await S({projectId:106,fieldId:491,fieldId2:601,dtFrom:t,dtTo:a}).then(i=>{if(i.length!==0){const y=i.reduce((e,s)=>(e[s.name]=(e[s.name]||0)+1,e),{});n=Object.entries(y).sort(([,e],[,s])=>s-e).slice(0,6).map(([e])=>e);const f=i.reduce((e,s)=>(n.includes(s.name)&&s.childIdNameCount.forEach(d=>{d.name==="关闭"?e.red[s.name]=(e.red[s.name]||0)+d.count:e.re[s.name]=(e.re[s.name]||0)+d.count}),e),{re:{},red:{}});l=[["已解决工单",...n.map(e=>f.red[e]||0)],["未解决工单",...n.map(e=>f.re[e]||0)]],F()}})};return h(()=>u.onResize,()=>{o==null||o.resize()}),h(()=>u.dateInfo,({start:t,end:a})=>{t&&a&&g(new Date(t).toISOString(),new Date(a).toISOString())},{deep:!0,immediate:!0}),x(()=>{o=I(document.getElementById("OrderStatus")),p()}),L(()=>{o==null||o.dispose()}),(t,a)=>(k(),A("div",{id:"OrderStatus",style:D({width:t.width,height:t.height})},null,4))}});export{v as default};
