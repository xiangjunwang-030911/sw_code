import{g as A,aq as M,ap as R,h as o,j as U,k as q,o as j,c as F,x as g,p as n,t as G,D as l,a5 as I,m as J,C as z,a4 as K,P as O,a8 as Q,Y as c,ai as W}from"./vendor-a962175c.js";import{u as X,h as Z,e as v,a as ee,p as te,j as ae,_ as se}from"./index-11d2d6b3.js";import{h as oe,i as ne}from"./index-8a0f43b8.js";const le={class:"flex justify-between items-center"},re={class:"border-b-0 font-semibold"},pe={class:"flex"},ie={class:"flex justify-center items-center"},ce={class:"flex justify-center items-center"},ue={key:0,class:"flex justify-center items-center"},b=1e3,de=A({__name:"Listview",props:{projectName:{default:""},projectId:{default:0},selectedStatus:{},isHome:{type:Boolean,default:!1}},setup(w){const r=w,T=X(),V=Z(),k=M(),D=R(),f=o(60),h=o(60),y=o(""),C=o([]),a=o({page:1,pageSize:10}),d=o([]),m=o(!1);let x=401,S=1;const E=e=>{k.push({path:"/ep/event/details",query:{id:e[401],projectId:r.projectId}}).then(()=>{V.addTagsViewList({title:`事件-${e[401]}`,name:`/ep/event/details?id=${e[401]}&projectId=${r.projectId}`,meta:D.meta})})},N=({prop:e,order:t})=>{x=t?+e:401,S=t===null||t==="ascending"?1:0,i()},L=e=>{a.value.pageSize=e,i()},B=e=>{a.value.page=e,i()},P=(e,t,s)=>s.fieldType==ae.DATE_TIME_FIELD&&e[t.property]?c("span",null,W(Number(e[t.property])).format("YYYY-MM-DD HH:mm")):s.fieldID==401?c("div",{class:"flex items-center"},[c(v,{iconClass:"ep-common-event",class:"mr-2 text-white"}),c("span",null,e[t.property]||null)]):c("span",null,e[t.property]||null),H=async()=>{const e=await oe({projectId:r.projectId,userId:T.getUserId});C.value=e.map(t=>({prop:t.fieldID.toString(),label:t.fieldName,sortable:"custom",render:({row:s,column:p})=>P(s,p,t)}))},i=async()=>{var t;m.value=!0;const e=await ne({projectId:r.projectId,userIds:"80",sortBy:x,orderBy:S,statusId:r.selectedStatus,pageNumber:a.value.page,pageSize:a.value.pageSize});f.value=e.opentotal,h.value=e.closetotal,a.value.total=e.total,d.value=((t=e.items)==null?void 0:t.map(s=>{let p={};return s.values.forEach(u=>p[u.id]=u.value),p}))||[],m.value=!1};return U(()=>r.selectedStatus,()=>{i()}),q(()=>{H(),i()}),(e,t)=>{const s=ee,p=te,u=K,Y=O,$=Q;return!e.isHome||d.value.length?(j(),F($,{key:0,class:"card mb-4 !mr-0",shadow:"hover"},{header:g(()=>[n("div",le,[n("p",re,G(e.projectName),1),n("div",pe,[n("div",ie,[l(v,{iconClass:"ep-home-EP_home_inProgress",className:"ml-[27px] mr-[6px]",size:"18"}),t[2]||(t[2]=n("span",{class:"pr-[7px] c-secondary"},"进行中",-1)),l(s,{class:I("text-[28px] oppo-font"),startVal:0,endVal:f.value,duration:b,separator:y.value,ref:"CountToPower"},null,8,["endVal","separator"])]),n("div",ce,[l(v,{iconClass:"ep-home-EP_home_finished",className:"ml-[27px] mr-[6px]",size:"18"}),t[3]||(t[3]=n("span",{class:"pr-[7px] c-secondary"},"已完成",-1)),l(s,{class:I("text-[28px] oppo-font"),startVal:0,endVal:h.value,duration:b,separator:y.value,ref:"CountToPower"},null,8,["endVal","separator"])])])])]),default:g(()=>[l(Y,{loading:m.value,rows:4,throttle:500},{default:g(()=>[l(p,{class:"scrollBar-light2 mb-3",columns:C.value,data:d.value,"max-height":400,onRowClick:E,onSortChange:N},null,8,["columns","data"]),e.isHome?z("",!0):(j(),J("div",ue,[l(u,{"current-page":a.value.page,"onUpdate:currentPage":t[0]||(t[0]=_=>a.value.page=_),"page-size":a.value.pageSize,"onUpdate:pageSize":t[1]||(t[1]=_=>a.value.pageSize=_),"page-sizes":[10,25,50,100],layout:"total, sizes, prev, pager, next, jumper",total:a.value.total,onSizeChange:L,onCurrentChange:B},null,8,["current-page","page-size","total"])]))]),_:1},8,["loading"])]),_:1})):z("",!0)}}});const ve=se(de,[["__scopeId","data-v-31412d96"]]);export{ve as default};
