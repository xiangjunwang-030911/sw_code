import{o as r,m as R,p as x,g as j,h as s,ak as D,bc as H,j as O,bd as P,k as W,G as $,c as i,x as v,D as b,l as a,L as A,C as p,be as G,n as U,t as Y,Y as f,aa as q,bf as J,a8 as Q}from"./vendor-a962175c.js";import{a as X}from"./index-162d97de.js";import{e as g,_ as Z}from"./index-11d2d6b3.js";import{u as ee}from"./useTableMaxHeight-bf759a94.js";import{u as ae}from"./knowledge-a2b5aa7f.js";import{u as te}from"./service-0e8ab2f5.js";import"./index-8a0f43b8.js";const oe={viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"};function se(S,u){return r(),R("svg",oe,u[0]||(u[0]=[x("path",{fill:"currentColor",d:"M512 64a32 32 0 0 1 32 32v192a32 32 0 0 1-64 0V96a32 32 0 0 1 32-32m0 640a32 32 0 0 1 32 32v192a32 32 0 1 1-64 0V736a32 32 0 0 1 32-32m448-192a32 32 0 0 1-32 32H736a32 32 0 1 1 0-64h192a32 32 0 0 1 32 32m-640 0a32 32 0 0 1-32 32H96a32 32 0 0 1 0-64h192a32 32 0 0 1 32 32M195.2 195.2a32 32 0 0 1 45.248 0L376.32 331.008a32 32 0 0 1-45.248 45.248L195.2 240.448a32 32 0 0 1 0-45.248m452.544 452.544a32 32 0 0 1 45.248 0L828.8 783.552a32 32 0 0 1-45.248 45.248L647.744 692.992a32 32 0 0 1 0-45.248M828.8 195.264a32 32 0 0 1 0 45.184L692.992 376.32a32 32 0 0 1-45.248-45.248l135.808-135.808a32 32 0 0 1 45.248 0m-452.544 452.48a32 32 0 0 1 0 45.248L240.448 828.8a32 32 0 0 1-45.248-45.248l135.808-135.808a32 32 0 0 1 45.248 0"},null,-1)]))}const ne={name:"ep-loading",render:se},le={class:"border-b-light border-b flex justify-between items-center"},re=j({__name:"KnowledgeTree",setup(S){const u=te(),T=ae(),l=s(""),w=s(),c=s(!1),E=s([1]),d=s(!1),y=s(),_=s(!0),k=s(0),F={children:"childFolders",label:"name"},m=s([]),K=D(H(w)),V=e=>{T.changeCurrentFolderId(e.id)},z=e=>{switch(!0){case e==1:return"ep-tree-icon_root";case e==2:return"ep-tree-icon_folder";case e>=3:return"ep-tree-icon_file";default:return""}},I=(e,{node:o,data:t})=>{const{level:n}=o;return f("div",{class:"w-full"},[f("div",{class:"flex items-center"},[f(g,{iconClass:z(n),class:"mr-1",size:15}),f("span",{style:{maxWidth:K.width-20-n*24+"px",overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis"},title:t.name},t.name)])])},M=async(e,o)=>{if(e.level===0)return o([{name:"知识库根目录",id:1,childFolders:[],status:"Open",childCount:1,isLeaf:!1}]);const t=await C(e.data.id,"");o(t)},C=async(e,o="")=>{const t=await X({ProjectID:u.getKnowledgeProjectId,ParentFolderID:e,keyWord:o||""});return(t==null?void 0:t.knowledgeFolders.map(n=>({...n,isLeaf:n.childCount==0})))||[]},L=()=>{c.value=!c.value,_.value=!1,setTimeout(()=>{_.value=!0},300)};return O(()=>l.value.trim(),P(async()=>{d.value=!0;const e=await C(1,l.value.trim());l.value.trim()?m.value=e:m.value=[{name:"知识库根目录",id:1,childFolders:e,status:"Open",childCount:1,isLeaf:!1}],d.value=!1},500)),W(()=>{$(()=>{var e;ee(k,(e=y.value)==null?void 0:e.$el)})}),(e,o)=>{const t=q,n=ne,N=J,B=Q;return r(),i(B,{ref_key:"cardRef",ref:w,class:"h-full",shadow:"hover","body-style":{padding:"21px 11px"}},{default:v(()=>[x("div",le,[b(t,{modelValue:a(l),"onUpdate:modelValue":o[0]||(o[0]=h=>A(l)?l.value=h:null),placeholder:"搜索目录"},null,8,["modelValue"]),!a(d)&&a(c)?(r(),i(g,{key:0,"icon-class":"ep-tree-icon_collapse",class:"cursor-pointer",size:14,onClick:L})):p("",!0),!a(d)&&!a(c)?(r(),i(g,{key:1,"icon-class":"ep-tree-icon_expand",class:"cursor-pointer",size:14,onClick:L})):p("",!0),a(d)?(r(),i(N,{key:2,class:"is-loading"},{default:v(()=>[b(n)]),_:1})):p("",!0)]),a(_)?(r(),i(a(G),{key:0,ref_key:"treeRef",ref:y,class:"mt-4 overflow-y-auto overflow-x-hidden",style:U({height:a(k)-40+"px"}),"node-key":"id",data:a(m),props:F,load:M,lazy:"","default-expand-all":a(c),"default-expanded-keys":a(E),"render-content":I,onNodeClick:V},{default:v(({data:h})=>[x("div",null,Y(h.label),1)]),_:1},8,["style","data","default-expand-all","default-expanded-keys"])):p("",!0)]),_:1},512)}}});const me=Z(re,[["__scopeId","data-v-762fc4d1"]]);export{me as default};
